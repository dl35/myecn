<mat-toolbar color="primary">
    <button mat-icon-button (click)="sidenav.toggle()" *ngIf="isCreated && !(layoutChanges | async)?.matches" >
        <mat-icon>menu</mat-icon>
      </button>
  Engagements


  <div  *ngIf="isCreated && (layoutChanges | async)?.matches"  fxLayout="column"  fxLayout="column"  fxFlex="100" fxLayoutAlign="center center" style='margin-top: 10px'  >
    
    <div  fxLayout="row" fxFlex="100" fxLayoutAlign="center center"  style='font-size: 14px'   >
          <mat-form-field fxFlex="25" fxFlexOffset="3" >
              <mat-select  color="primary" placeholder="Présence" [(ngModel)]="filtre.pre" name="pre" (ngModelChange)="doFilter()" >
                  <mat-option *ngFor="let p of pre" [value]="p.value">
                    {{p.viewValue}}
                  </mat-option>
                </mat-select>
          </mat-form-field>
   
          <mat-form-field fxFlex="25" fxFlexOffset="3" >
              <mat-select  color="primary" placeholder="Extranat" [(ngModel)]="filtre.ext" name="pre" (ngModelChange)="doFilter()" >
                  <mat-option *ngFor="let p of ext" [value]="p.value">
                    {{p.viewValue}}
                  </mat-option>
                </mat-select>
            </mat-form-field>
  
              <mat-form-field fxFlex="25" fxFlexOffset="3" >
                  <mat-select  color="primary" placeholder="Notifications" [(ngModel)]="filtre.notif" name="pre" (ngModelChange)="doFilter()" >
                      <mat-option *ngFor="let p of notif" [value]="p.value">
                        {{p.viewValue}}
                      </mat-option>
                    </mat-select>
                 </mat-form-field>
  
            </div>
  
   </div>

</mat-toolbar>
<mat-sidenav-container  style='height: 100vh;'  >
    <mat-sidenav color="primary" #sidenav style='height: 100vh;' fxLayout="column" mode="over" opened="false"   >
      <div fxLayout="column" fxLayoutAlign="center center" *ngIf="isCreated && !(layoutChanges | async)?.matches" >
          <mat-form-field style='width:60%' >
              <mat-select  color="primary" placeholder="Présence" [(ngModel)]="filtre.pre" name="pre" (ngModelChange)="doFilter()" >
                  <mat-option *ngFor="let p of pre" [value]="p.value">
                    {{p.viewValue}}
                  </mat-option>
                </mat-select>
          </mat-form-field>
          <mat-form-field style='width:60%' >
              <mat-select  color="primary" placeholder="Extranat" [(ngModel)]="filtre.ext" name="pre" (ngModelChange)="doFilter()" >
                  <mat-option *ngFor="let p of ext" [value]="p.value">
                    {{p.viewValue}}
                  </mat-option>
                </mat-select>
            </mat-form-field>
             <mat-form-field style='width:60%'>
                  <mat-select  color="primary" placeholder="Notifications" [(ngModel)]="filtre.notif" name="pre" (ngModelChange)="doFilter()" >
                      <mat-option *ngFor="let p of notif" [value]="p.value">
                        {{p.viewValue}}
                      </mat-option>
                    </mat-select>
                 </mat-form-field>
        
    
      </div>
    </mat-sidenav>
    <mat-sidenav-content>




  <div fxLayout="column"  fxFlex="95"  style='margin: auto;height: 100vh;' >
 
    <div fxLayout="row" fxLayoutAlign="center center" style="margin-top: 10px;"  >

      <button mat-mini-fab color="primary" *ngIf="isCreated" (click)="sendMails()">
        <mat-icon aria-label="email">email</mat-icon>
      </button>

      <mat-form-field style="width:60vw;margin-left:2vw;margin-right:2vw" >
        <mat-select  placeholder="Selection des compétitions" (ngModelChange)="setCompetition($event)" [formControl]="dataForm">

          <mat-option *ngFor="let item of datas$ | async ; last as last" [value]="item.id">
            {{item.id}} - {{item.label}}
          </mat-option>


        </mat-select>
      </mat-form-field>

      <button mat-mini-fab mat-icon-button *ngIf="isCreated"  color="primary" (click)="addLic()">
        <mat-icon aria-label="add">add</mat-icon>
      </button>
      &nbsp;
      <button mat-mini-fab mat-icon-button *ngIf="isCreated"  color="warn" (click)="delAll()">
          <mat-icon aria-label="add">delete</mat-icon>
        </button>


    </div>


    <app-engagement-create *ngIf="idc != -1 && !isCreated" [id]="idc"  (created)="setCreated($event)"   ></app-engagement-create>


    <div>

        <mat-list *ngIf="isCreated" >
      
        
        
        <h2 mat-subheader>Les Engagements ({{(engage$ | async)?.length}})</h2>
       
        <mat-list-item *ngFor="let item of engage$ | async ; last as last1" 
         style='margin-bottom:5px' class="mat-elevation-z4"     matRipple [matRippleCentered]="centered" [matRippleColor]="warn" >
    
          <p matLine style="margin-top:2em">
            <span class="mat-body-2">{{item.prenom}} {{item.nom}} ({{item.categorie}}{{item.rang}}-{{item.sexe}})</span>
          </p>
          <div style='width:20vw;float:right;' class="mat-body-2" >
          <mat-grid-list cols="3" rowHeight="28px">
              <mat-grid-tile *ngFor="let node of item.eng;" [ngSwitch]="node.presence" >
              <label *ngSwitchCase="'non'" style='border-radius:20%;background-color:red'color="warn" matTooltip="absent" ><s>&nbsp;&nbsp;{{node.day}}&nbsp;&nbsp;</s></label>
              <label  *ngSwitchCase="'oui'" style='border-radius:20%;background-color:green'color="primary" matTooltip="présent" >&nbsp;&nbsp;{{node.day}}&nbsp;&nbsp;</label>
              <label *ngSwitchDefault matTooltip="en attente"  style='border-radius:20%;background-color:lightskyblue' >&nbsp;&nbsp;{{node.day}}?&nbsp;&nbsp;</label>
              </mat-grid-tile>
            </mat-grid-list>
          </div>
        
          <div matLine style='margin-bottom:1em;' >
                   &nbsp;
            <button mat-icon-button style='margin-bottom:2em;' (click)="setNotification(item.id)" >
              <mat-icon aria-label="Email"   matBadge="{{item.notification}}" matBadgeSize="small" matBadgePosition="before"
              [ngStyle]="{color: item.notification > 0 ? 'green' : 'red' }"  >contact_mail</mat-icon>
            </button>
            &nbsp;&nbsp;
            <button mat-icon-button color="primary"  (click)="setExtranat(item.id)" *ngIf="item.notification > 0" >
              <mat-icon aria-label="Extranat" [ngStyle]="{color: item.extranat === 1 ? 'green' : 'red' }" matBadge="{{item.extranat}}" matBadgeSize="small" matBadgePosition="before">save</mat-icon>
            </button>
            <button mat-icon-button color="primary"  (click)="setDelete(item.id)"  *ngIf="item.notification === 0" >
              <mat-icon aria-label="Extranat" style='color:red' >delete</mat-icon>
            </button>
            
            <button  *ngIf="item.commentaire.length > 0"  mat-icon-button color="primary"  matTooltip="{{item.commentaire}}"  >
              <mat-icon aria-label="Comment" color="accent" >comment</mat-icon>
            </button>

                  </div>
    
          <mat-divider inset *ngIf="!last"></mat-divider>
        </mat-list-item>
    
    
      </mat-list>
    </div>



  </div>

</mat-sidenav-content>
</mat-sidenav-container>
